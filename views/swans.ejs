<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swan Migration Patterns</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <nav class="top-nav">
            <div class="nav-content">
                <h2>ü¶¢ Swan Migration</h2>
                <div class="nav-links">
                    <span>Welcome, <%= userInfo.email || userInfo.username %></span>
                    <a href="/logout" class="button small">Logout</a>
                </div>
            </div>
        </nav>

        <div class="content-section">
            <h1>The Great Swan Migration: A Continental Journey!</h1>
            
            <div class="image-container">
                <img id="swan-hero-image"
                     src="/assets/loading.jpg"  <!-- or any placeholder image -->
                     alt="Swans migrating in V-formation across the sky"
                     class="hero-image">
                <p class="image-caption">
                    Swans flying in their characteristic V-formation during migration
                    <span id="image-source" style="color: #9E9E9E; font-size: 0.8em;"> (üåê External)</span>
                </p>
            </div>

            <div class="content-grid">
                <div class="fact-box">
                    <h3>üåç Migration Routes</h3>
                    <p>Swans undertake some of the most remarkable migrations in the animal kingdom, traveling thousands of miles between their breeding and wintering grounds.</p>
                    <ul>
                        <li><strong>Tundra Swans:</strong> Migrate from Arctic Alaska to the mid-Atlantic coast of the United States</li>
                        <li><strong>Whooper Swans:</strong> Travel from Iceland and northern Europe to the British Isles and western Europe</li>
                        <li><strong>Trumpeter Swans:</strong> Move from Alaska and western Canada to the Pacific Northwest</li>
                    </ul>
                </div>

                <div class="fact-box">
                    <h3>üìè Migration Distance</h3>
                    <p>These magnificent birds can travel incredible distances:</p>
                    <ul>
                        <li>Up to <strong>4,000 miles</strong> one way</li>
                        <li>Flying at altitudes of up to <strong>26,000 feet</strong></li>
                        <li>Speeds reaching <strong>60 mph</strong> with tailwinds</li>
                        <li>Journey duration: <strong>2-3 months</strong> each way</li>
                    </ul>
                </div>

                <div class="fact-box">
                    <h3>üïí Timing</h3>
                    <p>Swan migration follows seasonal patterns:</p>
                    <ul>
                        <li><strong>Fall Migration:</strong> September to November</li>
                        <li><strong>Spring Migration:</strong> March to May</li>
                        <li><strong>Peak Activity:</strong> October and April</li>
                        <li><strong>Navigation:</strong> Using celestial cues, magnetic fields, and geographical landmarks</li>
                    </ul>
                </div>

                <div class="fact-box">
                    <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Behavior</h3>
                    <p>Swans are known for their strong family bonds during migration:</p>
                    <ul>
                        <li>Families migrate together in small groups</li>
                        <li>Young swans learn routes from their parents</li>
                        <li>Mate pairs stay together for life</li>
                        <li>They communicate with trumpet-like calls during flight</li>
                    </ul>
                </div>
            </div>

            <div class="migration-map">
                <h3>üó∫Ô∏è Major Swan Migration Flyways</h3>
                <div class="flyway-info">
                    <div class="flyway">
                        <h4>Atlantic Flyway</h4>
                        <p>From Arctic Canada to Chesapeake Bay, supporting thousands of Tundra Swans</p>
                    </div>
                    <div class="flyway">
                        <h4>Pacific Flyway</h4>
                        <p>Along the Pacific Coast from Alaska to California, crucial for Trumpeter Swans</p>
                    </div>
                    <div class="flyway">
                        <h4>European Flyway</h4>
                        <p>From Siberia and Scandinavia to Western Europe, used by Whooper and Mute Swans</p>
                    </div>
                </div>
            </div>

            <div class="conservation-note">
                <h3>üå± Conservation Efforts</h3>
                <p>Swan populations face challenges from climate change, habitat loss, and human interference. Conservation efforts include:</p>
                <ul>
                    <li>Protecting critical stopover sites</li>
                    <li>Monitoring migration patterns with GPS tracking</li>
                    <li>Reducing collisions with power lines and wind turbines</li>
                    <li>Maintaining clean water sources along migration routes</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- THIS IS THE NEW PART THAT TRIES YOUR IMAGE SERVICES -->
    <script>
        async function tryLoadImage(url, sourceName, color) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => {
                    // Immediately update the image and source when loaded
                    document.getElementById('swan-hero-image').src = url;
                    document.getElementById('image-source').innerHTML = 
                        `<span style="color: ${color}; font-size: 0.8em;"> (${sourceName})</span>`;
                    console.log(`Successfully loaded image from ${sourceName}`);
                    resolve();
                };
                img.onerror = (error) => {
                    console.log(`Failed to load image from ${sourceName}:`, error);
                    reject(error);
                };
                img.src = url;
            });
        }
        
        async function loadBestImage() {
            // Show loading state immediately
            document.getElementById('swan-hero-image').style.opacity = '0.5'; // dim the current image
            document.getElementById('image-source').innerHTML = 
                '<span style="color: #9E9E9E; font-size: 0.8em;"> (Loading...)</span>';
        
            const imagePath = '/assets/flying-swans.jpg'; // Adjust this path to match your image service
            const services = [
                {
                    url: `http://image-service.swan-prod.local${imagePath}`,
                    name: 'üì° PROD Service',
                    color: '#FF9800'
                },
                {
                    url: `http://image-service.swan-dev.local${imagePath}`,
                    name: 'üì° DEV Service',
                    color: '#2196F3'
                }
            ];
        
            let loaded = false;
        
            // Try each service in sequence until one works
            for (const service of services) {
                try {
                    console.log(`Attempting to load from ${service.name}...`);
                    await tryLoadImage(service.url, service.name, service.color);
                    loaded = true;
                    document.getElementById('swan-hero-image').style.opacity = '1';
                    break; // Exit once successful
                } catch (error) {
                    console.log(`Failed to load from ${service.name}`);
                }
            }
        
            // If all services fail, use local asset
            if (!loaded) {
                console.log('All services failed, using local asset');
                document.getElementById('swan-hero-image').src = '/assets/flying-swans.jpg';
                document.getElementById('swan-hero-image').style.opacity = '1';
                document.getElementById('image-source').innerHTML = 
                    '<span style="color: #9E9E9E; font-size: 0.8em;"> (Local Asset)</span>';
            }
        }
        
        // Start loading immediately when DOM is ready
        document.addEventListener('DOMContentLoaded', loadBestImage);
    </script>
</body>
</html>
